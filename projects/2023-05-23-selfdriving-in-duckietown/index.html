<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/brands.min.css><link rel=stylesheet type=text/css href=https://aishikpyne.com/css/style.css><script src=https://aishikpyne.com/js/darkmode.js></script><title>Aishik Pyne</title><script type=text/x-mathjax-config>
        MathJax.Hub.Config({
          TeX: {
              equationNumbers: {
                  autoNumber: "AMS"
              }
          },
          tex2jax: {
              inlineMath: [ ['$','$'], ["\\(","\\)"] ],
              displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
              processEscapes: true,
          }
        });
        MathJax.Hub.Register.MessageHook("Math Processing Error", function (message) {
            alert("Math Processing Error: " + message[1]);
        });
        MathJax.Hub.Register.MessageHook("TeX Jax - parse error", function (message) {
            alert("Math Processing Error: " + message[1]);
      });
      </script><script type=text/javascript async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script></head><body class="bg-zinc-50 dark:bg-black h-screen flex flex-col"><div class="fixed inset-0 flex justify-center tablet:px-8"><div class="flex w-full max-w-7xl desktop:px-8"><div class="w-full bg-white ring-1 ring-zinc-100 dark:bg-zinc-900 dark:ring-zinc-300/20"></div></div></div><nav class="fixed w-full mx-auto z-20 top-0 tablet:px-8"><div class="mx-auto max-w-7xl w-full desktop:px-8 mb-10"><div class="flex flex-wrap items-center p-4 tablet:px-4 bg-white dark:bg-zinc-900 gap-4"><div class="flex initial order-first"><a href=https://aishikpyne.com/ class="flex items-center"><span class="self-center whitespace-nowrap font-signature text-lg font-semibold dark:text-white">Aishik Pyne</span></a></div><div id=navbar-search class="hidden tablet:block mx-auto justify-center tablet:order-2 order-4 grow"><div class="flex justify-center"><ul class="flex items-center tablet:w-auto w-min justify-center tablet:flex-wrap rounded-full bg-white/90 px-3 text-sm font-medium text-zinc-800 shadow-lg shadow-zinc-800/5 ring-1 ring-zinc-900/5 backdrop-blur dark:bg-zinc-800/90 dark:text-zinc-200 dark:ring-white/10"><li><a class="relative block px-3 py-2 transition hover:text-pink-500 dark:hover:text-pink-400" href=/about>About</a></li><li><a class="relative block px-3 py-2 transition hover:text-pink-500 dark:hover:text-pink-400" href=/projects>Projects</a></li><li><a class="relative block px-3 py-2 transition hover:text-pink-500 dark:hover:text-pink-400" href=/articles>Articles</a></li><li><a class="relative block px-3 py-2 transition hover:text-pink-500 dark:hover:text-pink-400" href=/photography>Photography</a></li></ul></div></div><div class="flex grow tablet:grow-0 items-end justify-end order-3"><button id=theme-toggle type=button class="mx-2 rounded-lg p-2.5 text-sm text-zinc-500 hover:bg-zinc-100 focus:outline-none focus:ring-4 focus:ring-zinc-200 dark:text-zinc-400 dark:hover:bg-zinc-700 dark:focus:ring-zinc-700"><svg id="theme-toggle-dark-icon" class="hidden h-5 w-5" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001.0 1010.586 10.586z"/></svg><svg id="theme-toggle-light-icon" class="hidden h-5 w-5" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 011 1v1A1 1 0 119 4V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707A1 1 0 1113.536 5.05l.707-.707a1 1 0 011.414.0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707A1 1 0 004.343 5.757l.707.707zm1.414 8.486-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" fill-rule="evenodd" clip-rule="evenodd"/></svg></button>
<button data-collapse-toggle=navbar-search type=button class="inline-flex items-center rounded-lg p-2 text-sm text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600 tablet:hidden" aria-controls=navbar-search aria-expanded=false>
<span class=sr-only>Open menu</span><svg class="h-6 w-6" aria-hidden="true" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4A1 1 0 013 5zm0 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"/></svg></button></div></div></div></nav><div class="relative flex flex-col w-full mx-auto pt-16"><div class="max-w-prose m-6 mx-auto px-4 tablet:px-8"><header class="not-format mb-4 lg:mb-6 max-w-prose"><h1 class="mb-2 text-3xl font-extrabold leading-tight text-gray-900 dark:text-white tablet:text-3xl">Self driving car in Duckietown Simulation using Imitation learning</h1><p class="text-base font-light text-gray-500 dark:text-gray-400">May 6, 2023 · Aishik Pyne · 5 min</p></header><div class="mx-auto mb-4 max-w-prose rounded-lg border border-zinc-200 bg-white px-4 py-2 shadow dark:border-zinc-700 dark:bg-zinc-800 dark:text-white" id=accordion-collapse data-accordion=collapse><div id=accordion-collapse-heading-1 class=m0><button type=button class="flex w-full cursor-zoom-in items-center justify-between bg-inherit text-left font-medium text-zinc-900 dark:bg-inherit dark:text-zinc-200" data-accordion-target=#accordion-collapse-body-1 aria-expanded=false aria-controls=accordion-collapse-body-1>
<span class=text-bold>Table of Content</span><svg class="h-6 w-6 shrink-0" fill="currentcolor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414.0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414.0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/></svg></button></div><div id=accordion-collapse-body-1 class="prose prose-sm prose-a:no-underline hidden leading-tight dark:prose-invert" aria-labelledby=accordion-collapse-heading-1><nav id=TableOfContents><ul><li><a href=#problem-statement>Problem Statement</a></li><li><a href=#algorithm>Algorithm</a><ul><li><a href=#aligner>Aligner</a></li><li><a href=#high-level-planner>High Level Planner</a></li><li><a href=#lane-follower>Lane Follower</a></li><li><a href=#localization-module>Localization Module</a></li></ul></li><li><a href=#appendix>Appendix</a><ul><li><a href=#contributions-to-the-project>Contributions to the project</a></li></ul></li></ul></nav></div></div><article class="prose prose-zinc mx-auto dark:prose-invert
prose-img:mx-auto prose-img:rounded-lg
prose-figcaption:-mt-6 prose-figcaption:text-center"><p>Designing a completely autonomous-driving algorithm using Imitation Learning, A-Star Search, and MPC in Duckietown Simulation Environment.</p><p>This project was a part of my coursework at NUS, <a href=https://nusmods.com/courses/CS5478/intelligent-robots-algorithms-and-systems>CS5478: Intelligent Robots Spring 2023</a>, taught by <a href=https://www.comp.nus.edu.sg/~dyhsu/>Prof David Hsu</a>.
A PDF version of the project report can be found <a href=./docs/CS5478_IR_Project_Report.pdf>here</a></p><h2 id=problem-statement class="group hover:underline hover:underline-offset-6">Problem Statement <a href=#problem-statement class="opacity-0 group-hover:opacity-100">#</a></h2><p><strong>Setup:</strong> The Duckietown environment is driving simulator. On a high level it is a grid world where every grid or a tile is either drivable or not-drivable. This can be thought of a satellite map. On a lower level each drivable tile is either a two way road, a left or right turn, a 3 way or a 4 way junction. This can be thought of what a driver sees though the windshield during driving.</p><p>This world has right-hand drive, but there are no other cars on the road, and no traffic signs to follow.</p><p><strong>Objective:</strong> Given a GPS coordinates on an high-level map and a front facing camera feed, the goal is to design a self driving algorithm which can navigate from any starting point to a specified goal tile. Additionally, the algorithm must not deviate from the center of the right lane and reach the goal in the shortest time possible.</p><p><figure><a href=./images/selfdriving_large.gif title="Example of navigating on the road."><img src=./images/selfdriving_large.gif alt="Figure 1: Front Facing Camera Feed"></a><figcaption><strong>Figure 1: Front Facing Camera Feed:</strong>
Example of navigating on the road.</figcaption></figure></p><p><figure><a href="./images/HighLevelMap.jpeg?width=120px&amp;height=60px" title="Example Task on a High Level Map: The white squares are drivable, black squares are not drivable. The blue lines are lines inside the drivable (1) Blue Triangle is the start tile. (2) Red Cross is the goal tile (3) The small square form a path from the start to the goal. Color of the square represents is it has gone forward or taken a left or right turn"><img src="./images/HighLevelMap.jpeg?width=120px&amp;height=60px" alt="Figure 2: High Level Map"></a><figcaption><strong>Figure 2: High Level Map:</strong>
Example Task on a High Level Map: The white squares are drivable, black squares are not drivable. The blue lines are lines inside the drivable (1) Blue Triangle is the start tile. (2) Red Cross is the goal tile (3) The small square form a path from the start to the goal. Color of the square represents is it has gone forward or taken a left or right turn</figcaption></figure></p><h2 id=algorithm class="group hover:underline hover:underline-offset-6">Algorithm <a href=#algorithm class="opacity-0 group-hover:opacity-100">#</a></h2><p>I sectioned off the problem into components. First I will describe the components briefly and later go into the depth of each of the components.<figure><a href=./images/DuckieTownArchitecture.jpg><img src=./images/DuckieTownArchitecture.jpg alt="Figure: "></a><figcaption><strong>Figure: :</strong></figcaption></figure></p><ul><li><strong>Alignment Controller</strong>: When the episode starts, we have information about the X, Y coordinates of the current tile. However the orientation of the car is unknown. This is a challenge, since later in the algorithm we use high level intentions like left, right and forward to guide the low level controller. These intentions are relative to the current orientation of the car, thus the orientiation must be estimated during run time. Moreover, at the start, the car might spawn at any random orientation, so the best that can be done is to use camera observations to align the robot to the center of the right lane parallel to the edges of the road and then exiting the first time. This is the job of the aligner. Once the car moves of the next time, we have new GPS observation, which can be used to perfectly get the orientation or the car. Thus the control is passed to the high level planner.</li><li><strong>High Level Planner</strong>: In a 2D grid world, the car has 3 Degrees of Freedom (DOF): X, Y, and orientation $\theta$. Given the starting state, and the end tile coordinates, A-Star algorithm can be used to search a high level path and translate it into intentions, e.g. <code>L,L,F,F,F,R,L,R,L</code>. This high level plan is used by the intention conditioned Lane follower to reach the goal tile.</li><li><strong>Lane Follower</strong>: The job of this component is to drive as fast as possible on the center of the right lane, unless it&rsquo;s a 3 or 4 way junction. At the junction it must use the high-level intention to disambiguate which lane to follow and take the turn towards that lane. This will continue till the goal tile is reached.</li><li><strong>Localization Module</strong>: Once the end tile is reached, the car must recognize a building with a duck on the top and move towards it. The car is designed to perform tank turns till the current observation features match with the learned features of the building.</li></ul><h3 id=aligner class="group hover:underline hover:underline-offset-6">Aligner <a href=#aligner class="opacity-0 group-hover:opacity-100">#</a></h3><h4 id=analysis-of-start-tile class="group hover:underline hover:underline-offset-6">Analysis of Start tile <a href=#analysis-of-start-tile class="opacity-0 group-hover:opacity-100">#</a></h4><p>After multiple manual simulations, empirical observations were made about the starting position of the agent.</p><ul><li>The agent can start in either the right lane or the left lane. It might or might not be facing a lane. In extreme cases, it might not even have any information like yellow lanes, white lanes or red lines, such as looking at grass or at a junction.</li><li>There is a huge penalty when the agent is driving in the left lane. The objective is to move over to the right lane as quickly as possible without going off the road.</li></ul><h4 id=alignment-controller class="group hover:underline hover:underline-offset-6">Alignment Controller <a href=#alignment-controller class="opacity-0 group-hover:opacity-100">#</a></h4><p>Since the objective is to merge into the right lane, we need no intention.
We use a mix of the provided basic lane follower \cite{ProjectBasicLaneFollower} and our trained LaneFollower (described later). For the first few $t&lt;=0.05$ timesteps we use the given lane follower because when it is too close to the edge or it is facing the grass, it does tank turns. After this, our trained lane follower is capable to recover into a lane.</p><h3 id=high-level-planner class="group hover:underline hover:underline-offset-6">High Level Planner <a href=#high-level-planner class="opacity-0 group-hover:opacity-100">#</a></h3><p>The High-Level Planner performs global planning to find the shortest path from the 3rd tile to the goal tile using the <em><em>A</em> algorithm</em>*. As the heuristic, the <strong>Manhattan distance</strong> is used, and the cost to come was set to 1 for each neighbour. Note that multiple shortest paths can exist for a particular milestone because of loops in the map.</p><p>However, we can play to the Lane Following controller&rsquo;s strengths to choose from the set of shortest paths. We have observed that the LaneFollowing controller can move faster and collect more rewards when moving forward compared to turns. Moreover, left turns consistently incur less penalty than taking right turns. Thus while expanding the node we add additional cost based on \textit{Intention} used to expand the node: 1 for <strong>Forward</strong>, 2 for <strong>Left</strong>, and 4 for <strong>Right</strong></p><h3 id=lane-follower class="group hover:underline hover:underline-offset-6">Lane Follower <a href=#lane-follower class="opacity-0 group-hover:opacity-100">#</a></h3><h3 id=localization-module class="group hover:underline hover:underline-offset-6">Localization Module <a href=#localization-module class="opacity-0 group-hover:opacity-100">#</a></h3><h2 id=appendix class="group hover:underline hover:underline-offset-6">Appendix <a href=#appendix class="opacity-0 group-hover:opacity-100">#</a></h2><h3 id=contributions-to-the-project class="group hover:underline hover:underline-offset-6">Contributions to the project <a href=#contributions-to-the-project class="opacity-0 group-hover:opacity-100">#</a></h3><ul><li>Lane Follower: Aishik</li><li>Aligner: Aishik Pyne</li><li>High Level Planner: Aishik Pyne, Niharika Shrivastava</li><li>Localization Module: Niharika Shrivastava</li><li>Report Writing: Aishik Pyne, Niharika Shrivastavas</li></ul></article></div><footer id=footer class="max-w-7xl mx-auto w-full px-4 tablet:px-8 mt-8 tablet:mt-12 desktop:mt-16"><div class="w-full max-w-screen-xl mx-auto py-4 px-4 sm:px-8 lg:px-12"><hr class="my-4 border-zinc-200 sm:mx-auto dark:border-zinc-700 tablet:my-3"><div class="mx-auto max-w-2xl lg:max-w-5xl"><div class="flex flex-col w-full gap-4 py-4"><a href=https://aishikpyne.com/ class="mb-4 tablet:mb-0"><span class="text-center whitespace-nowrap font-signature text-lg font-semibold dark:text-white">Aishik Pyne</span></a><nav class="flex flex-col items-start justify-between gap-6 tablet:flex-row"><div class="flex flex-col flex-wrap justify-start tablet:justify-center gap-x-6 gap-y-1 text-sm font-medium text-zinc-800 dark:text-zinc-200 tablet:flex-row"><a class="transition hover:text-pink-500 dark:hover:text-pink-400" href=/about>About</a>
<a class="transition hover:text-pink-500 dark:hover:text-pink-400" href=/projects>Projects</a>
<a class="transition hover:text-pink-500 dark:hover:text-pink-400" href=/articles>Articles</a>
<a class="transition hover:text-pink-500 dark:hover:text-pink-400" href=/photography>Photography</a></div><p class="text-sm text-zinc-400 dark:text-zinc-500">© 2023 Aishik Pyne. All rights reserved.</p></nav></div></div></div></footer></div><script src=https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.6.6/flowbite.min.js></script>
<script>var themeToggleDarkIcon=document.getElementById("theme-toggle-dark-icon"),themeToggleBtn,themeToggleLightIcon=document.getElementById("theme-toggle-light-icon");localStorage.getItem("color-theme")==="dark"||!("color-theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?themeToggleLightIcon.classList.remove("hidden"):themeToggleDarkIcon.classList.remove("hidden"),themeToggleBtn=document.getElementById("theme-toggle"),themeToggleBtn.addEventListener("click",function(){themeToggleDarkIcon.classList.toggle("hidden"),themeToggleLightIcon.classList.toggle("hidden"),localStorage.getItem("color-theme")?localStorage.getItem("color-theme")==="light"?(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"))})</script></body></html>